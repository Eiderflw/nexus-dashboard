module.exports=[3793,a=>{"use strict";var b=a.i(67235),c=a.i(93835),d=a.i(1731),e=a.i(68206);let f=(0,e.default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var g=a.i(21528),h=a.i(92724);let i=(0,e.default)("power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);var j=a.i(58363),k=a.i(80184),l=a.i(78571);let m=(0,e.default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var n=a.i(94204);let o=(0,e.default)("code-xml",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);var p=a.i(60493),q=a.i(77697);function r(){let[a,e]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)("licenses"),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)({key:"",expires_at:"",active:!0,note:""}),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)("check-agency.js"),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(null),J=(0,c.useRef)(null);(0,c.useEffect)(()=>{e(!0)},[]);let K=async a=>{try{let b=await fetch(`/api/license/admin?token=${a}`);if(b.ok){let a=await b.json();y(a),u(!0)}else alert("Token de administrador invÃ¡lido")}catch(a){console.error(a)}},L=async(a,b)=>{try{let c=await fetch(`/api/license/admin?token=${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:a,licenseData:b})});if(c.ok){let b=await c.json();y(b.licenses),("add"===a||"update"===a)&&(A({key:"",expires_at:"",active:!0,note:""}),C(!1))}}catch(a){console.error(a)}},M=async()=>{if(!D||!F)return void I({msg:"Debes especificar nombre y contenido del script.",ok:!1});try{let a=await fetch(`/api/admin/scripts?token=${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:D,content:F})}),b=await a.json();a.ok?I({msg:b.message,ok:!0}):I({msg:b.error,ok:!1})}catch(a){I({msg:a.message,ok:!1})}};return t?(0,b.jsx)("div",{className:"min-h-screen bg-slate-950 p-6 md:p-12 text-slate-300",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[(0,b.jsx)(f,{className:"text-blue-500"})," Nexus Hub â€” Admin"]}),(0,b.jsx)("p",{className:"text-slate-500",children:"Panel de control de acceso y distribuciÃ³n de scripts"})]}),(0,b.jsxs)("div",{className:"bg-slate-900 px-4 py-2 rounded-lg border border-slate-800 text-xs text-green-400 font-mono flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-400 animate-pulse"})," CONECTADO"]})]}),(0,b.jsxs)("div",{className:"flex gap-2 mb-8 border-b border-slate-800",children:[(0,b.jsxs)("button",{onClick:()=>w("licenses"),className:`px-5 py-3 text-sm font-bold transition-colors flex items-center gap-2 border-b-2 -mb-px ${"licenses"===v?"border-blue-500 text-blue-400":"border-transparent text-slate-500 hover:text-slate-300"}`,children:[(0,b.jsx)(f,{className:"w-4 h-4"})," Licencias",(0,b.jsx)("span",{className:"bg-slate-800 px-2 py-0.5 rounded-full text-[10px]",children:x.length})]}),(0,b.jsxs)("button",{onClick:()=>w("scripts"),className:`px-5 py-3 text-sm font-bold transition-colors flex items-center gap-2 border-b-2 -mb-px ${"scripts"===v?"border-purple-500 text-purple-400":"border-transparent text-slate-500 hover:text-slate-300"}`,children:[(0,b.jsx)(o,{className:"w-4 h-4"})," Scripts"]})]}),"licenses"===v&&(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsxs)("div",{className:"lg:col-span-1 border border-slate-800 bg-slate-900 rounded-xl p-6 h-fit sticky top-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-bold text-white mb-6 flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[B?(0,b.jsx)(m,{className:"w-5 h-5 text-yellow-500"}):(0,b.jsx)(g.Plus,{className:"w-5 h-5 text-green-500"}),B?"Editar Licencia":"Crear Licencia"]}),B&&(0,b.jsx)("button",{onClick:()=>{C(!1),A({key:"",expires_at:"",active:!0,note:""})},className:"text-slate-500 hover:text-white transition-colors",children:(0,b.jsx)(n.X,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"CÃ“DIGO DE LLAVE"}),(0,b.jsx)("input",{type:"text",placeholder:"EJ: NEXUS-FREE-2026",className:`w-full bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white ${B?"opacity-50 cursor-not-allowed":""}`,value:z.key,onChange:a=>!B&&A({...z,key:a.target.value}),readOnly:B})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"FECHA DE VENCIMIENTO"}),(0,b.jsx)("input",{type:"datetime-local",className:"w-full bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white",value:z.expires_at,onChange:a=>A({...z,expires_at:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"USUARIO / NOTA"}),(0,b.jsx)("input",{type:"text",placeholder:"Nombre del cliente...",className:"w-full bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white",value:z.note,onChange:a=>A({...z,note:a.target.value})})]}),(0,b.jsx)("button",{onClick:()=>L(B?"update":"add",z),className:`w-full font-bold py-2 rounded transition-colors text-sm ${B?"bg-yellow-600 hover:bg-yellow-500 text-black":"bg-green-600 hover:bg-green-500 text-white"}`,children:B?"Actualizar Licencia":"Generar Licencia"})]})]}),(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[x.map(c=>(0,b.jsxs)("div",{className:"bg-slate-900 border border-slate-800 rounded-xl p-5 flex flex-col md:flex-row justify-between items-center gap-4 hover:border-slate-700 transition-all",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`p-3 rounded-lg border ${c.active?"bg-blue-500/10 border-blue-500/20":"bg-red-500/10 border-red-500/20"}`,children:(0,b.jsx)(f,{className:`w-6 h-6 ${c.active?"text-blue-500":"text-red-500"}`})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("span",{className:"font-bold text-white uppercase tracking-wider",children:c.key}),(0,b.jsx)("span",{className:`px-2 py-0.5 rounded-full text-[10px] uppercase font-bold ${c.active?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"}`,children:c.active?"Activo":"Baneado"}),c.active&&c.last_seen&&a&&(0,b.jsxs)("span",{className:`flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] uppercase font-bold ${new Date().getTime()-new Date(c.last_seen).getTime()<3e5?"bg-blue-500/20 text-blue-400":"bg-slate-800 text-slate-500"}`,children:[(0,b.jsx)("div",{className:`w-1.5 h-1.5 rounded-full ${new Date().getTime()-new Date(c.last_seen).getTime()<3e5?"bg-blue-400 animate-pulse":"bg-slate-600"}`}),new Date().getTime()-new Date(c.last_seen).getTime()<3e5?"ONLINE":"OFFLINE"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-xs text-slate-500 flex-wrap",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(k.User,{className:"w-3 h-3"})," ",c.note||"Sin nota"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(j.Clock,{className:"w-3 h-3"})," Exp: ",c.expires_at?.replace("T"," ")||"â€”"]}),(0,b.jsxs)("span",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] ${c.hwid?"text-blue-400 border border-blue-500/20":"text-slate-600 border border-slate-700"}`,children:["HWID: ",c.hwid?c.hwid.substring(0,12)+"...":"LIBRE"]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>{var a;C(!0),A({...c,expires_at:(a=c.expires_at)?a.includes("T")?a.substring(0,16):`${a}T00:00`:""}),window.scrollTo({top:0,behavior:"smooth"})},className:"p-2 rounded hover:bg-slate-800 text-blue-400 transition-colors",title:"Editar",children:(0,b.jsx)(m,{className:"w-5 h-5"})}),(0,b.jsx)("button",{onClick:()=>L("update",{...c,active:!c.active,reason:c.active?"Licencia suspendida por Admin":""}),className:`p-2 rounded hover:bg-slate-800 transition-colors ${c.active?"text-orange-500":"text-green-500"}`,title:c.active?"Suspender (Kill-Switch)":"Activar",children:(0,b.jsx)(i,{className:"w-5 h-5"})}),(0,b.jsx)("button",{onClick:()=>{confirm("Â¿Resetear el candado de hardware (HWID)? El usuario podrÃ¡ usar la llave en otra PC.")&&L("update",{...c,hwid:""})},className:`p-2 rounded hover:bg-slate-800 transition-colors ${c.hwid?"text-purple-400":"text-slate-600 opacity-30"}`,title:"Resetear HWID",disabled:!c.hwid,children:(0,b.jsx)(d.Shield,{className:"w-5 h-5"})}),(0,b.jsx)("button",{onClick:()=>{let a=prompt("RazÃ³n del bloqueo:",c.reason||"");null!==a&&L("update",{...c,active:!1,reason:a})},className:"p-2 rounded hover:bg-slate-800 text-yellow-500 transition-colors",title:"Bloquear con razÃ³n",children:(0,b.jsx)(l.AlertCircle,{className:"w-5 h-5"})}),(0,b.jsx)("button",{onClick:()=>confirm("Â¿Eliminar esta licencia?")&&L("delete",c),className:"p-2 rounded hover:bg-slate-800 text-red-500 transition-colors",title:"Eliminar",children:(0,b.jsx)(h.Trash2,{className:"w-5 h-5"})})]})]},c.key)),0===x.length&&(0,b.jsxs)("div",{className:"text-center py-20 bg-slate-900/50 rounded-xl border border-dashed border-slate-800",children:[(0,b.jsx)(f,{className:"w-12 h-12 text-slate-700 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-slate-600",children:"No hay licencias emitidas todavÃ­a."})]})]})]}),"scripts"===v&&(0,b.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,b.jsxs)("div",{className:"bg-slate-900 border border-slate-800 rounded-xl p-8",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold text-white mb-2 flex items-center gap-3",children:[(0,b.jsx)(o,{className:"text-purple-400"})," Subir Script al Hub"]}),(0,b.jsxs)("p",{className:"text-slate-500 text-sm mb-6",children:["El script se guarda en ",(0,b.jsx)("strong",{className:"text-slate-300",children:"Supabase"})," y se entrega cifrado a los loaders al autenticarse. Los cambios son instantÃ¡neos."]}),(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"NOMBRE DEL SCRIPT"}),(0,b.jsx)("input",{type:"text",placeholder:"check-agency.js",className:"w-full bg-slate-950 border border-slate-800 text-white rounded-lg px-4 py-3 text-sm focus:border-purple-500 outline-none font-mono",value:D,onChange:a=>E(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-slate-500",children:"CONTENIDO DEL SCRIPT"}),(0,b.jsxs)("button",{onClick:()=>J.current?.click(),className:"text-xs text-purple-400 hover:text-purple-300 flex items-center gap-1",children:[(0,b.jsx)(p.Upload,{className:"w-3 h-3"})," Cargar desde archivo"]})]}),(0,b.jsx)("input",{ref:J,type:"file",accept:".js,.ts,.mjs",className:"hidden",onChange:a=>{let b=a.target.files?.[0];if(!b)return;E(b.name);let c=new FileReader;c.onload=a=>G(a.target?.result),c.readAsText(b)}}),(0,b.jsx)("textarea",{className:"w-full bg-slate-950 border border-slate-800 text-green-400 rounded-lg px-4 py-3 text-xs font-mono focus:border-purple-500 outline-none resize-y",rows:18,placeholder:"// Pega o carga el contenido del script aquÃ­...",value:F,onChange:a=>G(a.target.value)}),(0,b.jsxs)("p",{className:"text-right text-xs text-slate-600 mt-1",children:[F.length.toLocaleString()," caracteres Â· ",F.split("\n").length," lÃ­neas"]})]}),(0,b.jsxs)("button",{onClick:M,disabled:!F||!D,className:"w-full bg-purple-700 hover:bg-purple-600 disabled:opacity-40 disabled:cursor-not-allowed text-white font-bold py-3 rounded-lg transition-colors flex items-center justify-center gap-2",children:[(0,b.jsx)(p.Upload,{className:"w-5 h-5"})," Publicar Script en el Hub"]}),H&&(0,b.jsxs)("div",{className:`flex items-start gap-3 p-4 rounded-lg border ${H.ok?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:[H.ok?(0,b.jsx)(q.CheckCircle,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}):(0,b.jsx)(l.AlertCircle,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),(0,b.jsx)("p",{className:"text-sm",children:H.msg})]}),(0,b.jsxs)("div",{className:"border border-dashed border-slate-800 rounded-lg p-4 text-xs text-slate-500 space-y-1",children:[(0,b.jsx)("p",{className:"font-bold text-slate-400 mb-2",children:"ðŸ“‹ Flujo de entrega segura:"}),(0,b.jsx)("p",{children:"1. Subes el script aquÃ­ â†’ Se guarda cifrado en Supabase"}),(0,b.jsxs)("p",{children:["2. El loader valida ",(0,b.jsx)("strong",{className:"text-slate-300",children:"Licencia + HWID"})," con el Hub"]}),(0,b.jsx)("p",{children:"3. Hub descarga el script de DB y lo envÃ­a en RAM"}),(0,b.jsxs)("p",{children:["4. Si suspendes una licencia â†’ el ",(0,b.jsx)("strong",{className:"text-slate-300",children:"Kill-switch"})," cierra el loader en â‰¤2 min"]})]})]})]})})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"max-w-md w-full bg-slate-900 rounded-xl border border-slate-800 p-8 shadow-2xl",children:[(0,b.jsx)("div",{className:"flex justify-center mb-6",children:(0,b.jsx)("div",{className:"w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center border border-blue-500/20",children:(0,b.jsx)(d.Shield,{className:"w-8 h-8 text-blue-500"})})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-center text-white mb-2",children:"Panel de Control"}),(0,b.jsx)("p",{className:"text-slate-400 text-center text-sm mb-8",children:"GestiÃ³n de licencias â€” Acceso Restringido"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-slate-500 ml-1",children:"USUARIO"}),(0,b.jsx)("input",{type:"text",placeholder:"Usuario...",className:"w-full bg-slate-950 border border-slate-800 text-white rounded-lg px-4 py-3 focus:border-blue-500 outline-none",value:r.split(":")[0]||"",onChange:a=>s(a.target.value+":"+(r.split(":")[1]||""))})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-slate-500 ml-1",children:"CONTRASEÃ‘A"}),(0,b.jsx)("input",{type:"password",placeholder:"ContraseÃ±a...",className:"w-full bg-slate-950 border border-slate-800 text-white rounded-lg px-4 py-3 focus:border-blue-500 outline-none",value:r.split(":")[1]||"",onChange:a=>s((r.split(":")[0]||"")+":"+a.target.value),onKeyDown:a=>{if("Enter"===a.key){let[a,b]=r.split(":");"nenegro"===a&&"Eider1993.1"===b?(K("nexus-master-key"),s("nexus-master-key")):alert("Credenciales incorrectas")}}})]}),(0,b.jsx)("button",{onClick:()=>{let[a,b]=r.split(":");"nenegro"===a&&"Eider1993.1"===b?(K("nexus-master-key"),s("nexus-master-key")):alert("Credenciales incorrectas")},className:"w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg transition-colors mt-2",children:"Acceder al Sistema"}),(0,b.jsx)("p",{className:"text-[10px] text-slate-600 text-center mt-4 italic",children:"Email de recuperaciÃ³n: eiderflw@gmail.com"})]})]})})}a.s(["default",()=>r],3793)}];

//# sourceMappingURL=nexus-dashboard_app_admin_licenses_page_tsx_b1fe86f8._.js.map